<!-- calendario-por-apartamento.component.html -->
<div class="detail-root" *ngIf="selectedApartment">
  <!-- CABEÇALHO COMPLETO -->
  <div class="detail-header">
    <!-- Linha superior: info + navegação -->
    <div class="header-top">
      <div class="detail-apartment-info">
        <div class="detail-apartment-dot" [style.background]="selectedApartment.color"></div>
        <div class="detail-apartment-title">{{ selectedApartment.name }}</div>
        <span class="detail-badge"
              [ngClass]="{
                'detail-available': selectedApartment.status === 'Disponível',
                'detail-occupied': selectedApartment.status === 'Ocupado',
                'detail-maintenance': selectedApartment.status === 'Manutenção'
              }">
          {{ selectedApartment.status }}
        </span>
      </div>

      <div class="detail-nav">
        <button class="detail-nav-button prev" (click)="changeMonth(-1)" aria-label="Mês anterior">‹ Anterior</button>
        <div class="detail-current-month">{{ currentMonthLabel | titlecase }}</div>
        <button class="detail-nav-button next" (click)="changeMonth(1)" aria-label="Próximo mês">Próximo ›</button>
      </div>
    </div>

    <!-- Linha inferior: métricas -->
    <div class="header-metrics">
      <div class="metric">
        <span class="metric-label">Ocupação</span>
        <span class="metric-value">{{ occupancyRate | number:'1.0-0' }}%</span>
      </div>
      <div class="metric airbnb">
        <span class="metric-label">Airbnb</span>
        <span class="metric-value">{{ airbnbCount }}</span>
      </div>
      <div class="metric booking">
        <span class="metric-label">Booking</span>
        <span class="metric-value">{{ bookingCount }}</span>
      </div>
    </div>
  </div>
<div *ngIf="loading" class="loading-overlay">
  <div class="spinner"></div>
</div>

  <!-- CALENDÁRIO -->
  <div class="detail-calendar-container">
    <div class="detail-weekdays-header">
      <div class="detail-weekday" *ngFor="let w of weekDays">{{ w }}</div>
    </div>

    <div class="detail-days-body">
      <div class="detail-day-cell"
           *ngFor="let day of calendarDays"
           [class.detail-outside]="!day.isCurrentMonth"
           [class.detail-today]="isToday(day.date)">
        <div class="detail-day-number">{{ day.date.getDate() }}</div>
        <ng-container *ngFor="let ev of day.events">
          <div class="detail-event" [ngClass]="ev.source === 'airbnb' ? 'event-airbnb' : 'event-booking'">
            {{ ev.cod_reserva }}
          </div>
        </ng-container>
      </div>
    </div>
  </div>

  <!-- LEGENDA -->
  <div class="detail-legend">
    <div class="detail-legend-item">
      <div class="detail-legend-dot booking"></div><span>Booking</span>
    </div>
    <div class="detail-legend-item">
      <div class="detail-legend-dot airbnb"></div><span>Airbnb</span>
    </div>
  </div>
</div>